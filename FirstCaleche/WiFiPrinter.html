<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ESP32 AJAX</title>
  <script>
    // Function to fetch data from ESP32
    function fetchData() {
      fetch("http://192.168.1.77/getData")  // Make sure the IP matches your ESP32 IP
        .then(response => response.json())
        .then(data => {
          // Update the page with the raw JSON response
          const rawData = JSON.stringify(data, null, 2); // Pretty-print JSON
          document.getElementById("rawResponse").innerText = rawData;

          // Update RPM value if present in the response
          if (data.rpm !== undefined) {
            document.getElementById("rpmValue").innerText = "RPM: " + data.rpm;
          }
          
          // Update Speed value if present in the response
          if (data.speed !== undefined) {
            document.getElementById("speedValue").innerText = "Speed: " + data.speed;
          }

          // Update Brake Lever Position if present in the response
          if (data.brakeLeverPosition !== undefined) {
            document.getElementById("brakeLeverPositionValue").innerText = "Brake Lever Position: " + data.brakeLeverPosition;
          }

          // Update Brake Servo Position if present in the response
          if (data.brakeServoPosition !== undefined) {
            document.getElementById("brakeServoPositionValue").innerText = "Brake Servo Position: " + data.brakeServoPosition;
          }

          // Update Message if present in the response
          if (data.message !== undefined) {
            document.getElementById("messageValue").innerText = "Message: " + data.message;
          }
        })
        .catch(error => {
          console.error('Error fetching data:', error);
        });
    }

    // Polling every second (1000ms)
    setInterval(fetchData, 1000);
  </script>
</head>
<body>
  <h1>Real-Time ESP32 Data:</h1>

  <!-- Display values for each type of data -->
  <div id="rpmValue">RPM: Waiting for data...</div>
  <div id="speedValue">Speed: Waiting for data...</div>
  <div id="brakeLeverPositionValue">Brake Lever Position: Waiting for data...</div>
  <div id="brakeServoPositionValue">Brake Servo Position: Waiting for data...</div>
  <div id="messageValue">Message: Waiting for data...</div>

  <h2>Raw Response:</h2>
  <pre id="rawResponse">Waiting for response...</pre>
</body>
</html>
